# 信息系统安全 笔记

### 第一节课

### 1. 系统的脆弱性

**定义**

脆弱性：从自身分析系统被威胁而出现异常的各种根源和因素，导致系统呈现一些薄弱环节和漏洞

**根源**

- 基于信息属性的本源性脆弱：信息易复制性和易伪性
- 基于系统结构复杂性的结构性脆弱：系统功能庞大结构复杂
- 基于攻防不对称性的普通性脆弱：攻击薄弱的全线防御
- 基于网络的开放和数据库共享的应用脆弱性

**主要方面**

- 芯片的脆弱性
- 操作系统的安全漏洞
- 数据库的安全脆弱性
- 计算机网络的安全脆弱性（网络协议、网络应用）

### 2. 安全威胁与攻击

**定义**

安全威胁：对于信息系统的组成要素及其功能造成某种损害的潜在可能

攻击：安全威胁的具体实现

**安全威胁的分类**

- 按照作用对象：针对信息、针对系统
- 按照威胁来源：内部威胁和外部威胁，进一步细分为自然灾害威胁，滥用性威胁和有意人为威胁

**攻击的主要形式**

- 恶意代码攻击：病毒、特洛伊木马、蠕虫、陷门和逻辑炸弹等

  恶意代码：具有目的性、传播性和破坏性

  病毒：具有传染性、潜伏性、隐藏性和寄生性

  特洛伊木马：具有目的性、功能特殊性、非授权性、受控性、非自我繁殖性和欺骗性

- 窃听攻击：声波窃听、电磁波窃听、光缆窃听、手机窃听、网络窃听

- 黑客攻击：信息系统敏感数据获取、网络欺骗漏洞攻击（**ARP欺骗——交换网络监听**、IP源地址欺骗、TCP会话劫持、DNS欺骗、Web欺骗和钓鱼网站）、数据驱动漏洞攻击、拒绝服务攻击（IP碎片与IP碎片漏洞、死亡之ping攻击、UDP泛洪攻击、**SYN泛洪攻击**、MAC泛洪攻击）、陷门攻击

- 社交工程

**🔺病毒、蠕虫与木马比较**

| 比较项目 | 木马     | 病毒             | 蠕虫               |
| -------- | -------- | ---------------- | ------------------ |
| 自我繁殖 | 几乎没有 | 强               | 强                 |
| 攻击对象 | 网络     | 文件             | 计算机、网络、进程 |
| 传播途径 | 植入     | 文件感染         | 漏洞               |
| 欺骗性   | 强       | 一般             | 一般               |
| 攻击方式 | 窃取信息 | 破坏数据         | 消耗资源           |
| 远程控制 | 可       | 否               | 否                 |
| 存在形式 | 隐藏     | 寄生在宿主程序中 | 独立存在           |
| 运行规则 | 自主运行 | 条件触发         | 自主运行           |

**风险**

风险=脆弱性+威胁

风险损失——信息资源损失：机密性、完整性、可用性、真实性

归分为三大类：信息破坏、信息泄密、假冒或否认

### 3. 信息系统安全概念和内涵

**概念**

- 信息安全，强度内容安全，包括数据与知识产权等方面的安全
- 网络安全，强调保护网络应用与信息网络基础设施等

**内涵：三个层次**

- 通信保密：采用的基本技术是加密，或者叫密码技术

- 信息防护：从机密性的基础上，扩充为完整性、可用性、真实性和可控性。**被动的防御思想**。具体目标包括系统保护和信息内容保护。防护的概念经历了计算机安全和计算机网络两阶段

- 信息保障：PDR（Protection-Detection-Response、防护-检测-响应）模型。**检测是一种主动防御思想**。增加了可验证性和不可否认性。

  🔺PDR模型内涵：从被动防御到主动防御，从静态防御到动态防御，**提出了安全策略概念**，强调充分考虑人的管理因素。安全策略：根据风险分析产生的描述系统中哪些资源要得到保护，以及如何实现对它们的保护等内容，**是安全保障的核心**

### 4. 信息系统安全体系

**概念**

信息系统安全体系的形成是通过对于系统的风险分析提出**安全需求**，制定**安全策略**，再根据安全策略，决定系统的安全功能-**安全服务**，并通过相应的**安全机制**来实现所需要的安全服务。

包括两大部分内容：安全服务，即安全机制所提供对付安全威胁的功能及其配备位置。安全机制，是安全服务的具体实现。

**信息系统安全体系标准**

标准可提供一个指导原则和约束条件

GB/T 9387.2 1995 相当于 ISO/IEC 7498-2

ISO/IEC 7498-2：建立在OSI7层协议之上的标准，定义了5类安全服务，8种特定安全机制，5种普通安全机制，确定了安全服务与安全机制的关系，确定了安全管理。

**OSI安全体系的安全服务**

- 鉴别服务：通过对通信的对等实体（主体）和数据源的鉴别和确认来对抗假冒性攻击以及重放性攻击。包括主机地址鉴别、进程地址鉴别、人员账户鉴别
- 访问控制服务：防止系统资源的非授权访问。
- 机密性服务：防止被动攻击（攻击者获取信息），防止数据非授权泄露。包括数据机密性保护，业务流机密性保护
- 完整性服务：对抗主动攻击（攻击者修改数据），保护数据在存储、传输等过程种不被非授权修改，以提供真实准确的数据
- 抗抵赖服务：提供证据证实某通信实体的诚实性。包括有数据原发证明的抗抵赖，防止发送方抵赖和有数据交付证明的抗抵赖，防止接收方抵赖

| 安全服务/OSI层次                     | 物理层 | 数据链路层 | 网络层 | 传输层     | 会话层 | 表示层 | 应用层 |
| ------------------------------------ | ------ | ---------- | ------ | ---------- | ------ | ------ | ------ |
| 鉴别服务/访问控制服务                | N      | N          | Y      | Y          | N      | N      | Y      |
| 机密性服务(数据/连接机密性)          | Y      | Y          | Y      | Y(SSL/TLS) | N      | Y      | Y      |
| 完整性服务（带恢复功能的连接完整性） | N      | N          | N      | Y          | N      | N      | Y      |
| 抗抵赖服务                           | N      | N          | N      | Y          | N      | N      | Y      |

**OSI安全体系安全机制**

**基本安全机制**

- 加密机制：机密性保护，采用密码、信息隐藏等方法
- 数据签名机制：认证或抗抵赖服务
- 访问控制机制：数据机密性、完整性和可用性保护
- 完整性保护机制：鉴别码（抗修改），顺序号（防乱序），时间标记（防重放，防丢失）
- 通信业务填充机制：业务流机密性保护的反分析机制
- 路由选择控制机制：便于只是用物理上安全的子网络、中继站或链路进行通信
- 公证机制：由可信第三方提供的安全保护机制
- 鉴别交互机制：对等实体鉴别，采用技术有鉴别信息（如口令）和密码技术

**安全机制和安全服务的关系**

|                                   | 加密 | 数字签名 | 访问控制 | 数据完整性 | 鉴别交换 | 通信业务填充 | 路由选择控制 | 公证 |
| --------------------------------- | ---- | -------- | -------- | ---------- | -------- | --------------- | ---------- | ---- |
| 鉴别服务（对等实体）              | Y    | Y        | N        | N          | Y        | N               | N          | N    |
| 鉴别服务（数据源发）              | Y    | Y        | N        | N          | N        | N               | N          | N    |
| 访问控制服务                      | Y    | N        | Y        | N          | N        | N               | N          | N    |
| 机密性服务（连接/无连接的机密性） | Y    | N        | N        | N          | N        | N               | Y          | N    |
| 完整性服务（连接完整性）          | Y    | N        | N        | Y          | N        | N               | N          | N    |

**普通安全机制**

- 安全标记机制：为某资源制定安全属性约束
- 事件监测机制：对与安全有关事件的监测
- 安全审计跟踪机制：记录并调查安全事件
- 安全恢复机制：安全事件处理后进行系统恢复
- 可信功能机制：提供对某些硬件和软件可信赖的保证，如可信计算安全模块

**信息安全管理**

安全管理中，安全策略是核心，是整个信息系统安全的依据。

**作用**

建立一个具有指导性的安全技术和管理规范，是进行系统分析的基础上，对控制策略，安全模型，安全等级，评价标准等提出的一个基本框架性文件。

**安全管理活动**

安全服务管理、安全机制管理、安全事件处理管理、安全审计管理、安全恢复管理、安全行政管理、系统安全管理

**安全防御原则**

木桶原则（均衡防护原则）、成本效益原则、可扩展性原则、分权制衡原则、最小特权原则、失效保护原则、公开揭露原则、可评估原则



### 第二节课

### 1. 加密概念和古典密码体制

**数据机密性保护**

- 可读性保护：数据加密技术
- 可见性保护：数据隐藏技术

**数据加密**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/cipher.png)  

加密算法分类：  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/ciphersort.PNG)  

**古典密码体制**

古典密码密钥空间小，难抵抗琼剧密钥攻击

- 替代密码：将明文中每个位置的字母都用其他字母代替，如

  凯撒密码算法：明文字母替换为字母表中后面的距离为5的字母，C -> H等

  维吉利亚密码：首先按照密钥长度将明文分解为若干节，对每一个明文字母，利用密钥和维吉利亚方阵（第a行以A开头）进行替换操作

  多名替换密码和多字母密码

- 换位密码：将明文中字母的位置重新排列，如

  将明文倒序输出

  列换位法：将明文按密钥长度排列成明文矩阵，按密钥字母在字母表中的顺序输出明文中的矩阵

### 2. 现代密码体制

加密：C=E_ek(M)

解密：M=D_dk(C)

E：加密函数、ek：加密密钥、D：解密函数、dk：解密密钥

**对称密码体制**

加密与解密使用相同密钥，ek=dk

- 流加密：RC4算法

通常对明文与密钥流进行逐比特位bit进行加密操作（异或运算）

密钥流：基于种子密钥K，通过密钥流生成函数不断产生。种子密钥K通常仅使用在一个通信会话中，不重复使用。

密钥流（生成函数）安全属性：有很长周期，伪随机性

一次一密流加密：密钥流使用**真随机源**产生的比特流（要求无周期性），且只使用一次进行进行加密，具有信息论意义上的**无条件安全**。由于真随机源难实现，因此它不具有现实可用性。**现代流加密通常用线性反馈移位寄存器结构**构建密钥流生成函数，产生有很长周期的密钥流

- 块加密：DES算法和AES算法

将明文编码（如0，1编码），并按一定长度（m）进行分组，再将各组明文的编码分别在密钥的控制下进行加密。块加密除了用于加密，还可以用于构造消息认证码算法

块加密操作模式：

ECB（Electronic Code Book)：ECB模式中，密钥应作为会话密钥

CBC（Cipher Block Chaining）

DES加密算法：56位有效密钥长度，DES可被暴力攻击

3DES加密算法：使用2个密钥，c=e_k1(d_k2(e_k1(m)))，e/d为DES加密和解密

AES加密算法：固定块长度128位，可变密钥长度：128/192/256位

对称体制——共享密钥问题：使用密钥分配中心KDC，每个实体只与KDC共享密钥，规模庞大时密钥管理困难

**非对称密码体制**

加密与解密使用不同密钥，ek!=dk

基本思想：每个通信实体生成一个密钥对，满足①两个密钥具有某种数学联系、②知道其中一个密钥求解对应另一个密钥是困难的、③用其中一个密钥进行加密，可用对应的另一个密钥解密。通信时，实体将自己加密密钥（公钥PK）公开，将解密密钥（私钥SK）保密持有。

单向陷门函数：依赖于数学难题，如离散对数难题、大整数素因子分解难题

RSA加密算法：依赖于大整数素因子分解难题，使用1024/2048位

**对称和非对称体制比较**

A与B保密通信

- 对称加密：运算效率高、使用方便、加密效率高
- 非对称加密：运算效率低。A和B各产生自己的一对密钥，A（B）将PK在公开信道传输给B（A），A（B）保密SK

**密码体制的安全性分析**

- 算法安全：算法公开，并接受分析与攻击
- 密钥安全：密钥保密，不能泄露

🔺密码体制安全性应基于密钥安全性

### 3. 密钥管理

**概念**

信息系统安全至关重要的工作，包括密钥生成，分配，使用，更新，撤销和销毁等一系列过程

- 密钥生成：密钥越长，强度越大
- 密钥分配：密钥发送与验证。分为网外分配（使用秘密新式携带密钥分配）和网内分配（直接分配或通过KDC分配）
- 密钥控制使用：限制密钥主权人、合法使用期限、预定用途和预定算法
- 密钥保护与存储：秘密共享，不以明文方式、物理安全



### 第三节课

### 1. 数据保护——完整性 消息认证码

**数据完整性保护概念**

- 内容篡改：对报文内容的插入，删除，改变等
- 序列篡改：对报文序列的插入，删除，错序等
- 时间篡改：对报文进行延迟或者回放

🔺完整性包括内容完整性、序列完整性和时间完整性

**消息认证（安全服务）**

概念：用于验证所收到的消息确实来自真正的发送方，并未受到内容篡改，序列篡改和时间篡改攻击，又称**报文鉴别**。

- 内容认证：**消息认证的核心**
- 序列认证：通过报文序号，接收方检查序号来鉴别报文序列是否遭受攻击
- 时间认证：数据实时性保护，采用时间戳或**询问——应答机制**进行确认

**消息认证码（安全机制）**

从功能上可分为两个层次：

- 底层是认证函数，认证函数功能是能够由报文产生具有唯一性的鉴别码
- 上层是认证协议

基本原理：

1. 利用认证函数生成基于报文的鉴别码A
2. 将报文（是否保密取决应用需求）+ 鉴别码A发送给接收方
3. 接收方由报文生成鉴别码B，由于鉴别码唯一性，如果A=B，说明报文没有受到针对内容完整性的攻击

**认证函数：生成鉴别码的方法（MAC）**

**放图mac**

基于MAC（Message Authentication Code，消息认证码）的方法，使用一个由密钥控制的鉴别码生成函数基于报文的固定长的鉴别码。

**MAC函数**

与加密函数类似，均需要通信双方共享密钥，但有本质区别。

- 加密算法要求可逆性。MAC算法不要求可逆性
- 加密函数明文长度与密文长度一般相同，是一对一的函数。MAC中消息可以任意长，但生成的鉴别码长度固定，存在M ! = M* ，但是它们的MAC相等（多对一）
- MAC函数比加密函数更不容易被攻破

安全MAC函数具备的性质：

- 已知M和MAC，要找到满足MAC* = MAC的另一个M* ，在计算上不可能
- MAC均匀分布，对随机选择的M和M* ，使得MAC* = MAC的概率是 2的(-n)次方，n为MAC长度
- 如果M* 是 M的一个已知变换，则使得MAC*= MAC的概率是 2的(-n)次方
- MAC函数所需要密钥长度必须足够抵抗穷举密钥攻击
- 如果明文也需要机密性保护，必须使用另外一个密钥，不可同时使用MAC密钥作为加密密钥

CBC-MAC：

**放图cbcmac**

- ANSI标准，又称数据认证算法
- 建立在DES基础，基于分组密码，并按照CBC模式操作的MAC构造方法之一

**哈希函数**

将任意长的输入消息串通过哈希算法（H）变换成固定长度的输出串，该输出串就是哈希值，又称数据指纹

哈希函数具备的性质：

- H可以应用于任意长度的输入数据块，产生固定长度的哈希值（效率考虑）
- 给定M，计算h=H(M)很容易；给定h，找到一个M使得h=H(M)在计算上不可能，即单向性
- 对于给定M和哈希值h，要找到另外一个M* !=M，使得H(M*)=H(M)在计算上不可能，即弱抗碰撞性（防止替代性报文，伪造）
- 找到任何M!=M*且H(M)=H(M *)在计算上不可能，即强抗碰撞性（抗生日攻击，复杂度2的80次方）

**实际应用中哈希函数**

MD5算法：

- 不以任何假设和密码体制为基础，是一个直接构造出来的算法。
- 哈希值长度：128bits
- 主要应用：防篡改鉴别（软件下载）和加密（口令保存）
- 王小云教授公开找到MD5产生碰撞的方法（复杂度2的40次方）

SHA(Secure Hash Algorithm)安全哈希算法，包括SHA-1,SHA-224,SHA-256等：

- 基于MD4构造
- 哈希值长度：160bits
- 主要应用：数字签名标准算法（DSS）中
- 王小云教授公开找到SHA-0产生碰撞的方法（复杂度2的40次方）

SHA-1与MD5的比较

SHA-1比MD5的抗穷举攻击能力强，执行速度相对较慢

| 算法  | 哈希值长度bit | 最大报文长度    | 分组处理长度bit |
| ----- | ------------- | --------------- | --------------- |
| MD5   | 128           | 无限制          | 512             |
| SHA-1 | 160           | （2的64次方）-1 | 512             |

**认证函数：生成鉴别码的方法（MD）**

基于报文（消息）摘要的方法，将报文使用单向杂凑（hash）函数变换成为具有固定长度的鉴别码。Hash函数不使用密钥，通常配合其他安全机制使用。Hash(M,K)



### 2. 数据保护——不可否认性 数字签名

**不信任：否认与抵赖**

在通信过程中，有时发生一方对另一方进行如下欺骗行为：

- 否认：发送方否认自己发送过某个报文，或接收方接收一个报文后，否定接受过

- 冒充：发送方冒充第三方给接收方发送报文

- 伪造：某一方自己伪造一份报文，却声称来自对方

- 篡改：接收方接收到一份报文后，却说这是对方发过来的报文原样

在通信双方尚未建立起信任关系且存在利益冲突情况下，单纯的消息认证无法有效解决上述问题，为此应采用数字签名技术

**数字签名**

数字签名是附加在数据单元上的一些数据，或对数据单元所做的密码变换，这种数据和变换允许数据单元的接收者用以确认数据单元来源和数据单元的完整性，并保护数据，防止被人（如接收者）进行伪造。

数据签名是实现数据的不可否认性保护的安全机制。

**数据签名技术要求**

- 签名的生产，识别和验证应比较容易
- 签名能够用于证实被签名报文内容的真实性
- 签名的结果必须是与签名的报文相关的二进制串
- 签名能够验证签名者的身份以及签名的时间
- 用已知的签名构造一个新的报文或者由已知的报文产生一个假冒的签名在计算上不可行
- 签名可以由第三方验证，以解决双方在通信中的争议

**直接数字签名**

**放图signature**

- 签名过程只有发送方和接收方参与
- 前提条件是接收方可以通过某种方式验证发送方提交的凭证/签名，也可在发送争议时将凭证交第三方仲裁
- 使用对称加密构造，仅抵抗冒充，无法抵抗否认、篡改和伪造
- 使用非对称加密构造，A用私钥将报文加密，将其发送给B后，B用A的公钥将密文解密
- 公钥算法效率慢，上述过程通过先将报文M通过一个单向哈希函数生成长鉴别码，将消息认证与签名结合进行
- 这过程中A不可能冒充第三方，也无法否认自己的发送，B也无法篡改和伪造，B可以否认接受
- 有仲裁的数字签名涉及第三方参与，可提供更全的完整性和不可否认性保护

**数字签名算法**

- RSA-based签名算法，RSA-PSS
- DSA数字签名算法



### 3. 公钥基础设施

**中间人攻击（针对公钥系统）**

**放图middle_attack**

**数字证书**

- 公钥证书，包含姓名、组织、邮箱等个人信息，以及属于此人的公钥，并有认证机构（CA）施加的数字签名
- 只要看到数字证书，就可以知道认证机构认定该证书中的公钥的确属于证书中声明的实体
- 认证机构中国际性组织，政府所设立的组织，也有通过提供认证服务来盈利的一般企业等（如VeriSign、GlobalSign）
- 证书标准规范X.509
- 查看浏览器中的证书，windows证书管理器(certmgr.msc)

**公钥基础设施PKI**

- 为了能够更有效运用公钥而制定的一系列规范和规格的总称
- PKI组成要素：用户/实体、认证机构（生成密钥对、注册证书、作废证书与CRL）、证书仓库
- 证书的层次结构（证书链）：顶级认证机构 --> 下一级

**可信第三方**

如认证机构（CA）

**数字证书与HTTPS**



### 第四节课

