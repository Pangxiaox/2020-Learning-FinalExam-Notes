# 信息系统安全 笔记

### 第一节课

### 1. 系统的脆弱性

**定义**

脆弱性：从自身分析系统被威胁而出现异常的各种根源和因素，导致系统呈现一些薄弱环节和漏洞

**根源**

- 基于信息属性的本源性脆弱：信息易复制性和易伪性
- 基于系统结构复杂性的结构性脆弱：系统功能庞大结构复杂
- 基于攻防不对称性的普通性脆弱：攻击薄弱的全线防御
- 基于网络的开放和数据库共享的应用脆弱性

**主要方面**

- 芯片的脆弱性
- 操作系统的安全漏洞
- 数据库的安全脆弱性
- 计算机网络的安全脆弱性（网络协议、网络应用）

### 2. 安全威胁与攻击

**定义**

安全威胁：对于信息系统的组成要素及其功能造成某种损害的潜在可能

攻击：安全威胁的具体实现

**安全威胁的分类**

- 按照作用对象：针对信息、针对系统
- 按照威胁来源：内部威胁和外部威胁，进一步细分为自然灾害威胁，滥用性威胁和有意人为威胁

**攻击的主要形式**

- 恶意代码攻击：病毒、特洛伊木马、蠕虫、陷门和逻辑炸弹等

  恶意代码：具有目的性、传播性和破坏性

  病毒：具有传染性、潜伏性、隐藏性和寄生性

  特洛伊木马：具有目的性、功能特殊性、非授权性、受控性、非自我繁殖性和欺骗性

- 窃听攻击：声波窃听、电磁波窃听、光缆窃听、手机窃听、网络窃听

- 黑客攻击：信息系统敏感数据获取、网络欺骗漏洞攻击（**ARP欺骗——交换网络监听**、IP源地址欺骗、TCP会话劫持、DNS欺骗、Web欺骗和钓鱼网站）、数据驱动漏洞攻击、拒绝服务攻击（IP碎片与IP碎片漏洞、死亡之ping攻击、UDP泛洪攻击、**SYN泛洪攻击**、MAC泛洪攻击）、陷门攻击

- 社交工程

**🔺病毒、蠕虫与木马比较**

| 比较项目 | 木马     | 病毒             | 蠕虫               |
| -------- | -------- | ---------------- | ------------------ |
| 自我繁殖 | 几乎没有 | 强               | 强                 |
| 攻击对象 | 网络     | 文件             | 计算机、网络、进程 |
| 传播途径 | 植入     | 文件感染         | 漏洞               |
| 欺骗性   | 强       | 一般             | 一般               |
| 攻击方式 | 窃取信息 | 破坏数据         | 消耗资源           |
| 远程控制 | 可       | 否               | 否                 |
| 存在形式 | 隐藏     | 寄生在宿主程序中 | 独立存在           |
| 运行规则 | 自主运行 | 条件触发         | 自主运行           |

**风险**

风险=脆弱性+威胁

风险损失——信息资源损失：机密性、完整性、可用性、真实性

归分为三大类：信息破坏、信息泄密、假冒或否认

### 3. 信息系统安全概念和内涵

**概念**

- 信息安全，强度内容安全，包括数据与知识产权等方面的安全
- 网络安全，强调保护网络应用与信息网络基础设施等

**内涵：三个层次**

- 通信保密：采用的基本技术是加密，或者叫密码技术

- 信息防护：从机密性的基础上，扩充为完整性、可用性、真实性和可控性。**被动的防御思想**。具体目标包括系统保护和信息内容保护。防护的概念经历了计算机安全和计算机网络两阶段

- 信息保障：PDR（Protection-Detection-Response、防护-检测-响应）模型。**检测是一种主动防御思想**。增加了可验证性和不可否认性。

  🔺PDR模型内涵：从被动防御到主动防御，从静态防御到动态防御，**提出了安全策略概念**，强调充分考虑人的管理因素。安全策略：根据风险分析产生的描述系统中哪些资源要得到保护，以及如何实现对它们的保护等内容，**是安全保障的核心**

### 4. 信息系统安全体系

**概念**

信息系统安全体系的形成是通过对于系统的风险分析提出**安全需求**，制定**安全策略**，再根据安全策略，决定系统的安全功能-**安全服务**，并通过相应的**安全机制**来实现所需要的安全服务。

包括两大部分内容：安全服务，即安全机制所提供对付安全威胁的功能及其配备位置。安全机制，是安全服务的具体实现。

**信息系统安全体系标准**

标准可提供一个指导原则和约束条件

GB/T 9387.2 1995 相当于 ISO/IEC 7498-2

ISO/IEC 7498-2：建立在OSI7层协议之上的标准，定义了5类安全服务，8种特定安全机制，5种普通安全机制，确定了安全服务与安全机制的关系，确定了安全管理。

**OSI安全体系的安全服务**

- 鉴别服务：通过对通信的对等实体（主体）和数据源的鉴别和确认来对抗假冒性攻击以及重放性攻击。包括主机地址鉴别、进程地址鉴别、人员账户鉴别
- 访问控制服务：防止系统资源的非授权访问。
- 机密性服务：防止被动攻击（攻击者获取信息），防止数据非授权泄露。包括数据机密性保护，业务流机密性保护
- 完整性服务：对抗主动攻击（攻击者修改数据），保护数据在存储、传输等过程种不被非授权修改，以提供真实准确的数据
- 抗抵赖服务：提供证据证实某通信实体的诚实性。包括有数据原发证明的抗抵赖，防止发送方抵赖和有数据交付证明的抗抵赖，防止接收方抵赖

| 安全服务/OSI层次                     | 物理层 | 数据链路层 | 网络层 | 传输层     | 会话层 | 表示层 | 应用层 |
| ------------------------------------ | ------ | ---------- | ------ | ---------- | ------ | ------ | ------ |
| 鉴别服务/访问控制服务                | N      | N          | Y      | Y          | N      | N      | Y      |
| 机密性服务(数据/连接机密性)          | Y      | Y          | Y      | Y(SSL/TLS) | N      | Y      | Y      |
| 完整性服务（带恢复功能的连接完整性） | N      | N          | N      | Y          | N      | N      | Y      |
| 抗抵赖服务                           | N      | N          | N      | Y          | N      | N      | Y      |

**OSI安全体系安全机制**

**基本安全机制**

- 加密机制：机密性保护，采用密码、信息隐藏等方法
- 数据签名机制：认证或抗抵赖服务
- 访问控制机制：数据机密性、完整性和可用性保护
- 完整性保护机制：鉴别码（抗修改），顺序号（防乱序），时间标记（防重放，防丢失）
- 通信业务填充机制：业务流机密性保护的反分析机制
- 路由选择控制机制：便于只是用物理上安全的子网络、中继站或链路进行通信
- 公证机制：由可信第三方提供的安全保护机制
- 鉴别交互机制：对等实体鉴别，采用技术有鉴别信息（如口令）和密码技术

**安全机制和安全服务的关系**

|                                   | 加密 | 数字签名 | 访问控制 | 数据完整性 | 鉴别交换 | 通信业务填充 | 路由选择控制 | 公证 |
| --------------------------------- | ---- | -------- | -------- | ---------- | -------- | --------------- | ---------- | ---- |
| 鉴别服务（对等实体）              | Y    | Y        | N        | N          | Y        | N               | N          | N    |
| 鉴别服务（数据源发）              | Y    | Y        | N        | N          | N        | N               | N          | N    |
| 访问控制服务                      | Y    | N        | Y        | N          | N        | N               | N          | N    |
| 机密性服务（连接/无连接的机密性） | Y    | N        | N        | N          | N        | N               | Y          | N    |
| 完整性服务（连接完整性）          | Y    | N        | N        | Y          | N        | N               | N          | N    |

**普通安全机制**

- 安全标记机制：为某资源制定安全属性约束
- 事件监测机制：对与安全有关事件的监测
- 安全审计跟踪机制：记录并调查安全事件
- 安全恢复机制：安全事件处理后进行系统恢复
- 可信功能机制：提供对某些硬件和软件可信赖的保证，如可信计算安全模块

**信息安全管理**

安全管理中，安全策略是核心，是整个信息系统安全的依据。

**作用**

建立一个具有指导性的安全技术和管理规范，是进行系统分析的基础上，对控制策略，安全模型，安全等级，评价标准等提出的一个基本框架性文件。

**安全管理活动**

安全服务管理、安全机制管理、安全事件处理管理、安全审计管理、安全恢复管理、安全行政管理、系统安全管理

**安全防御原则**

木桶原则（均衡防护原则）、成本效益原则、可扩展性原则、分权制衡原则、最小特权原则、失效保护原则、公开揭露原则、可评估原则



### 第二节课

### 1. 加密概念和古典密码体制

**数据机密性保护**

- 可读性保护：数据加密技术
- 可见性保护：数据隐藏技术

**数据加密**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/cipher.png)  

加密算法分类：  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/ciphersort.PNG)  

**古典密码体制**

古典密码密钥空间小，难抵抗琼剧密钥攻击

- 替代密码：将明文中每个位置的字母都用其他字母代替，如

  凯撒密码算法：明文字母替换为字母表中后面的距离为5的字母，C -> H等

  维吉利亚密码：首先按照密钥长度将明文分解为若干节，对每一个明文字母，利用密钥和维吉利亚方阵（第a行以A开头）进行替换操作

  多名替换密码和多字母密码

- 换位密码：将明文中字母的位置重新排列，如

  将明文倒序输出

  列换位法：将明文按密钥长度排列成明文矩阵，按密钥字母在字母表中的顺序输出明文中的矩阵

### 2. 现代密码体制

加密：C=E_ek(M)

解密：M=D_dk(C)

E：加密函数、ek：加密密钥、D：解密函数、dk：解密密钥

**对称密码体制**

加密与解密使用相同密钥，ek=dk

- 流加密：RC4算法

通常对明文与密钥流进行逐比特位bit进行加密操作（异或运算）

密钥流：基于种子密钥K，通过密钥流生成函数不断产生。种子密钥K通常仅使用在一个通信会话中，不重复使用。

密钥流（生成函数）安全属性：有很长周期，伪随机性

一次一密流加密：密钥流使用**真随机源**产生的比特流（要求无周期性），且只使用一次进行进行加密，具有信息论意义上的**无条件安全**。由于真随机源难实现，因此它不具有现实可用性。**现代流加密通常用线性反馈移位寄存器结构**构建密钥流生成函数，产生有很长周期的密钥流

- 块加密：DES算法和AES算法

将明文编码（如0，1编码），并按一定长度（m）进行分组，再将各组明文的编码分别在密钥的控制下进行加密。块加密除了用于加密，还可以用于构造消息认证码算法

块加密操作模式：

ECB（Electronic Code Book)：ECB模式中，密钥应作为会话密钥

CBC（Cipher Block Chaining）

DES加密算法：56位有效密钥长度，DES可被暴力攻击

3DES加密算法：使用2个密钥，c=e_k1(d_k2(e_k1(m)))，e/d为DES加密和解密

AES加密算法：固定块长度128位，可变密钥长度：128/192/256位

对称体制——共享密钥问题：使用密钥分配中心KDC，每个实体只与KDC共享密钥，规模庞大时密钥管理困难

**非对称密码体制**

加密与解密使用不同密钥，ek!=dk

基本思想：每个通信实体生成一个密钥对，满足①两个密钥具有某种数学联系、②知道其中一个密钥求解对应另一个密钥是困难的、③用其中一个密钥进行加密，可用对应的另一个密钥解密。通信时，实体将自己加密密钥（公钥PK）公开，将解密密钥（私钥SK）保密持有。

单向陷门函数：依赖于数学难题，如离散对数难题、大整数素因子分解难题

RSA加密算法：依赖于大整数素因子分解难题，使用1024/2048位

**对称和非对称体制比较**

A与B保密通信

- 对称加密：运算效率高、使用方便、加密效率高
- 非对称加密：运算效率低。A和B各产生自己的一对密钥，A（B）将PK在公开信道传输给B（A），A（B）保密SK

**密码体制的安全性分析**

- 算法安全：算法公开，并接受分析与攻击
- 密钥安全：密钥保密，不能泄露

🔺密码体制安全性应基于密钥安全性

### 3. 密钥管理

**概念**

信息系统安全至关重要的工作，包括密钥生成，分配，使用，更新，撤销和销毁等一系列过程

- 密钥生成：密钥越长，强度越大
- 密钥分配：密钥发送与验证。分为网外分配（使用秘密新式携带密钥分配）和网内分配（直接分配或通过KDC分配）
- 密钥控制使用：限制密钥主权人、合法使用期限、预定用途和预定算法
- 密钥保护与存储：秘密共享，不以明文方式、物理安全



### 第三节课

### 1. 数据保护——完整性 消息认证码

**数据完整性保护概念**

- 内容篡改：对报文内容的插入，删除，改变等
- 序列篡改：对报文序列的插入，删除，错序等
- 时间篡改：对报文进行延迟或者回放

🔺完整性包括内容完整性、序列完整性和时间完整性

**消息认证（安全服务）**

概念：用于验证所收到的消息确实来自真正的发送方，并未受到内容篡改，序列篡改和时间篡改攻击，又称**报文鉴别**。

- 内容认证：**消息认证的核心**
- 序列认证：通过报文序号，接收方检查序号来鉴别报文序列是否遭受攻击
- 时间认证：数据实时性保护，采用时间戳或**询问——应答机制**进行确认

**消息认证码（安全机制）**

从功能上可分为两个层次：

- 底层是认证函数，认证函数功能是能够由报文产生具有唯一性的鉴别码
- 上层是认证协议

基本原理：

1. 利用认证函数生成基于报文的鉴别码A
2. 将报文（是否保密取决应用需求）+ 鉴别码A发送给接收方
3. 接收方由报文生成鉴别码B，由于鉴别码唯一性，如果A=B，说明报文没有受到针对内容完整性的攻击

**认证函数：生成鉴别码的方法（MAC）**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/mac.PNG)  

基于MAC（Message Authentication Code，消息认证码）的方法，使用一个由密钥控制的鉴别码生成函数基于报文的固定长的鉴别码。

**MAC函数**

与加密函数类似，均需要通信双方共享密钥，但有本质区别。

- 加密算法要求可逆性。MAC算法不要求可逆性
- 加密函数明文长度与密文长度一般相同，是一对一的函数。MAC中消息可以任意长，但生成的鉴别码长度固定，存在M ! = M* ，但是它们的MAC相等（多对一）
- MAC函数比加密函数更不容易被攻破

安全MAC函数具备的性质：

- 已知M和MAC，要找到满足MAC* = MAC的另一个M* ，在计算上不可能
- MAC均匀分布，对随机选择的M和M* ，使得MAC* = MAC的概率是 2的(-n)次方，n为MAC长度
- 如果M* 是 M的一个已知变换，则使得MAC*= MAC的概率是 2的(-n)次方
- MAC函数所需要密钥长度必须足够抵抗穷举密钥攻击
- 如果明文也需要机密性保护，必须使用另外一个密钥，不可同时使用MAC密钥作为加密密钥

CBC-MAC：  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/cbcmac.PNG)  

- ANSI标准，又称数据认证算法
- 建立在DES基础，基于分组密码，并按照CBC模式操作的MAC构造方法之一

**哈希函数**

将任意长的输入消息串通过哈希算法（H）变换成固定长度的输出串，该输出串就是哈希值，又称数据指纹

哈希函数具备的性质：

- H可以应用于任意长度的输入数据块，产生固定长度的哈希值（效率考虑）
- 给定M，计算h=H(M)很容易；给定h，找到一个M使得h=H(M)在计算上不可能，即单向性
- 对于给定M和哈希值h，要找到另外一个M* !=M，使得H(M*)=H(M)在计算上不可能，即弱抗碰撞性（防止替代性报文，伪造）
- 找到任何M!=M*且H(M)=H(M *)在计算上不可能，即强抗碰撞性（抗生日攻击，复杂度2的80次方）

**实际应用中哈希函数**

MD5算法：

- 不以任何假设和密码体制为基础，是一个直接构造出来的算法。
- 哈希值长度：128bits
- 主要应用：防篡改鉴别（软件下载）和加密（口令保存）
- 王小云教授公开找到MD5产生碰撞的方法（复杂度2的40次方）

SHA(Secure Hash Algorithm)安全哈希算法，包括SHA-1,SHA-224,SHA-256等：

- 基于MD4构造
- 哈希值长度：160bits
- 主要应用：数字签名标准算法（DSS）中
- 王小云教授公开找到SHA-0产生碰撞的方法（复杂度2的40次方）

SHA-1与MD5的比较

SHA-1比MD5的抗穷举攻击能力强，执行速度相对较慢

| 算法  | 哈希值长度bit | 最大报文长度    | 分组处理长度bit |
| ----- | ------------- | --------------- | --------------- |
| MD5   | 128           | 无限制          | 512             |
| SHA-1 | 160           | （2的64次方）-1 | 512             |

**认证函数：生成鉴别码的方法（MD）**

基于报文（消息）摘要的方法，将报文使用单向杂凑（hash）函数变换成为具有固定长度的鉴别码。Hash函数不使用密钥，通常配合其他安全机制使用。Hash(M,K)



### 2. 数据保护——不可否认性 数字签名

**不信任：否认与抵赖**

在通信过程中，有时发生一方对另一方进行如下欺骗行为：

- 否认：发送方否认自己发送过某个报文，或接收方接收一个报文后，否定接受过

- 冒充：发送方冒充第三方给接收方发送报文

- 伪造：某一方自己伪造一份报文，却声称来自对方

- 篡改：接收方接收到一份报文后，却说这是对方发过来的报文原样

在通信双方尚未建立起信任关系且存在利益冲突情况下，单纯的消息认证无法有效解决上述问题，为此应采用数字签名技术

**数字签名**

数字签名是附加在数据单元上的一些数据，或对数据单元所做的密码变换，这种数据和变换允许数据单元的接收者用以确认数据单元来源和数据单元的完整性，并保护数据，防止被人（如接收者）进行伪造。

数据签名是实现数据的不可否认性保护的安全机制。

**数据签名技术要求**

- 签名的生产，识别和验证应比较容易
- 签名能够用于证实被签名报文内容的真实性
- 签名的结果必须是与签名的报文相关的二进制串
- 签名能够验证签名者的身份以及签名的时间
- 用已知的签名构造一个新的报文或者由已知的报文产生一个假冒的签名在计算上不可行
- 签名可以由第三方验证，以解决双方在通信中的争议

**直接数字签名**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/signature.PNG)  

- 签名过程只有发送方和接收方参与
- 前提条件是接收方可以通过某种方式验证发送方提交的凭证/签名，也可在发送争议时将凭证交第三方仲裁
- 使用对称加密构造，仅抵抗冒充，无法抵抗否认、篡改和伪造
- 使用非对称加密构造，A用私钥将报文加密，将其发送给B后，B用A的公钥将密文解密
- 公钥算法效率慢，上述过程通过先将报文M通过一个单向哈希函数生成长鉴别码，将消息认证与签名结合进行
- 这过程中A不可能冒充第三方，也无法否认自己的发送，B也无法篡改和伪造，B可以否认接受
- 有仲裁的数字签名涉及第三方参与，可提供更全的完整性和不可否认性保护

**数字签名算法**

- RSA-based签名算法，RSA-PSS
- DSA数字签名算法



### 3. 公钥基础设施

**中间人攻击（针对公钥系统）**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/middle_attack.PNG)  

**数字证书**

- 公钥证书，包含姓名、组织、邮箱等个人信息，以及属于此人的公钥，并有认证机构（CA）施加的数字签名
- 只要看到数字证书，就可以知道认证机构认定该证书中的公钥的确属于证书中声明的实体
- 认证机构中国际性组织，政府所设立的组织，也有通过提供认证服务来盈利的一般企业等（如VeriSign、GlobalSign）
- 证书标准规范X.509
- 查看浏览器中的证书，windows证书管理器(certmgr.msc)

**公钥基础设施PKI**

- 为了能够更有效运用公钥而制定的一系列规范和规格的总称
- PKI组成要素：用户/实体、认证机构（生成密钥对、注册证书、作废证书与CRL）、证书仓库
- 证书的层次结构（证书链）：顶级认证机构 --> 下一级

**可信第三方**

如认证机构（CA）

**数字证书与HTTPS**



### 第四节课

### 1. 身份认证

**鉴别服务**

定义：通过对通信的对等实体（主体）和数据源的鉴别和确认，以对抗假冒性攻击以及重放性攻击

分类：①网络层鉴别-主机地址鉴别（防火墙）、②传输层鉴别-进程地址鉴别（防火墙）、③应用层鉴别-人员账户鉴别

**身份认证与访问控制**

为了系统的安全，需要对系统访问进行管制约束。

访问涉及两方面：①主体，通常指用户、②客体：资源，即数据

身份认证：对主体合法性的认证

访问控制：对于主体的访问行为进行授权的过程

**身份认证与访问控制模型**

不同的合法用户可能有不同权限  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/id.PNG)  

**基于凭证比对的身份认证**

定义：用户提交能代表身份的凭证与系统中存储的凭证进行对比

身份凭证分类：

①用户所知道的密码，如口令，个人识别号PIN和密钥等

②用户所拥有的信物，如信用卡，IC卡，USB Key等

③用户自身的生物特征，如指纹，虹膜纹等

单元素、双因素认证

**静态口令**

使用度最高的一类身份认证机制

特点：①账户公开，口令保密、②简单易用，效率高，但极为脆弱，容易受攻击

攻击方法：①在线暴力猜测、字典猜测、②针对口令文件的非在线暴力猜测与字典猜测、③网络窃听，键盘记录器，社交工程等

安全保护策略：

①口令选择：扩大口令字符空间、选择长口令、不同系统使用不同口令

②正确使用口令：经常更换口令，限制登录时间等

③安全保护口令：不存储明文，而是哈希值

**批量登录攻击（在线）与验证码**

批量登录攻击：即在线暴力破解

验证码：

①也称为CAPTCHA，全自动区分计算机和人类的图灵测试

②强制用户在登录时进行人工操作，通常需要用户从模糊的图形之中辨认出隐藏在其中的一些信息

③验证码通常随机生成，并具有一定的生存周期

破解验证码的方法：①图像识别，人工智能、②人工打码平台

reCAPTCHA与古籍识别：将OCR软件无法识别的文字扫描图传给世界各大网站，用以替换原来的验证码图片，那些网站的用户在正确识别出这些文字之后，其答案便被传回，从而将古籍转化为电子文档

**动态口令**

一次性口令，是最安全的口令

根据专门算法生成一个不可预测的随机数字组合，每一个密码只能使用一次。通常由专门的口令生成器生成，又称为令牌，包括短信密码、手机令牌、硬件令牌等

广泛应用于网上银行，电子商务等场景：6位的数字验证码

生成动态口令技术：

①时间同步口令：基于令牌与服务器的时间同步，并采用国际标准时间，一般每60s产生一个新口令

②事件同步：通过某一特定的事件次序及相同的种子值作为输入，通过哈希算法运算出一致的密码

③异步口令：主要采用挑战/应答方式

挑战-应答技术

①C -> S：userid，客户发送认证请求

②S -> C：r，服务器发送挑战，r为随机数

③C -> S：f(r||pwd)，f一般为哈希函数，pwd为C与S共享的长期密码

④收到客户的应答f(r||pwd)时，服务器可对r和pwd做同样的计算，如两者相同，则认证通过

🔺pwd在认证过程中不以明文方式提交



###  2. 访问控制

对通过认证的合法用户，其对系统资源的访问行为需要依据安全策略进行控制

从系统资源安全保护的角度对访问进行授权控制：

- 客体：资源，指文件/目录等，访问属性：读/写/执行等
- 主体：访问发起者，指用户，进程以及服务等

授权：就是通过赋予主体一定的权限（读，写等），赋予客体一定的访问属性（读，写等），同时在主体与客体之间建立一套安全访问规则，实施主体访问客体的管理

通过制定的安全访问机制，确保主体对客体的访问是经过授权的，同时要拒绝非授权的访问，以保证信息的**机密性，完整性和可用性**（系统为合法用户持续提供服务的能力）

**访问控制的二元关系描述**

对主体设定的访问控制（规则）可用一个二元组（控制对象，访问类型）来表示

- 控制对象：系统资源，如文件
- 访问类型：对资源的访问，如读，写，执行等

二元组描述形式：①访问控制矩阵、②授权关系表、③访问能力表、④访问控制列表

**访问控制矩阵**

又称访问许可矩阵，用行表示客体，列表示主体，在行列交叉处设定访问权限

例子：系统用户A，B和C，资源包括文件F1,F2和F3

|      | F1      | F2      | F3      |
| ---- | ------- | ------- | ------- |
| A    | OWN,R,W |         | OWN,R,W |
| B    | R       | OWN,R,W | W       |
| C    | R,W     | R       |         |

OWN：所有权、R：读、W：写

**访问控制列表（Access Control List，ACL）**

从客体出发描述控制信息，可以用对某一个资源制定任意一个用户的访问权限  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/ACL.PNG)  

**自主、强制访问控制**

制定访问控制策略时，通常考虑资源所有权的概念：资源的所有者往往是资源创建者

**基于所有权的访问控制**

①自主访问控制，广泛应用在操作系统中，如单机系统

- 计算机系统中应用最广泛的一种策略
- 基本思想：资源的所有者可以对资源的访问进行控制，任意规定谁可以访问其资源，自主地直接或间接地将权限传给主体
- 特点：权限传递，灵活，但也容易造成安全漏洞

②强制访问控制，广泛应用在军事系统中，如网络系统

- 基本思想：系统“强制”主体服从访问控制政策，系统（系统管理员）给主体和客体分配了不同安全属性，用户不能改变自身或者任何客体的安全属性，即不允许单个用户确定访问权限，只有系统管理员才可以确定用户的访问权限。

**基于角色的访问控制策略**

角色：一个组织或任务中的岗位，职位或分工。角色需要用户去扮演或承担  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/信息系统安全/role.PNG)  

角色实际上是在主体（用户）和客体之间引入的中间控制机制层，实现权限与职责的分离；同时由于角色比个体用户具有较大的稳定性，极大地方便了权限管理



### 第五节课

### 1. 密码技术

**密码技术的工具箱**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/keytec.PNG)  

**对称加密**

- 加密密钥EK = 解密密钥DK
- 加密速度快，适合加密大量数据
- 流密码：密钥依赖伪随机数生成器产生的密钥流
- 块密码（分组密码）：块大小与密钥长度，通常对明文块迭代，迭代的具体方式称为模式，如CBC等
- DES密码与AES算法
- 对称密码，又称私钥密码，单钥密码等

**公钥加密**

- 加密密钥EK != 解密密钥DK，具有严格数学关系，又称为密钥对
- 加密密钥EK，公开发布，称为公钥
- 解密密钥DK，拥有者保密持有，又称私钥
- 速度远低于对称密码，适合加密小量数据，如一个对称密钥
- RSA密码系统，黄金标准
- 攻击：除了期望获取对应私钥，还可进行中间人攻击

**混合密码系统**

- 用对称密码提高速度，用公钥密码保护会话密钥

  ①使用对称密码加密消息

  ②通过伪随机数生成器生成对称密码加密中使用的会话密钥

  ③用公钥密码加密会话密钥

  ④从混合密码系统外部赋予公钥密码加密时使用的密钥对

- 会话密钥：指为本次通信而生成的临时密钥，一般比明文短很多

- PGP，IPSec和SSL/TLS等都运用了混合密码系统

**安全随机数生成**

**认证/鉴别-完整性-单向散列函数**

- 认证/鉴别

  消息源，来自哪里/信息内容，是否被篡改

  用途：检测软件是否被篡改/消息认证码/数字签名/伪随机数生成器

- 单向散列函数

  H(M*) = h，任意长消息到定长消息的映射

- 构造性攻击：H(M1) = H(M2)，M1 != M2

  ①抗弱碰撞性，给定M1，进行构造

  ②抗强碰撞性，构造M1和M2

  ③攻击方式：暴力破解/生日攻击

- MD5和SHA-1等，又称为消息摘要，哈希和杂凑函数

**认证/鉴别-完整性-消息认证码**

- MAC(M,K)，与散列函数不同，需要输入共享密钥

  ①使用散列函数构建，称为HMAC

  ②使用分组密码构建，如DES-CBC

- 消息认证码是一种与密钥相关联的单向散列函数

- 面临对称加密系统中相同的密钥配送问题

- 攻击方式：

  ①推测密钥

  ②重放攻击：序号与时间戳

- 无法解决的问题：第三方证明和防止否认

**数字签名**

- 数字签名是根据消息内容生成的一串”只有自己才能计算出来的数值“

  生成消息签名和验证数字签名

- 可通过公钥加密系统构建数字签名

  私钥加密，即签名/公钥解密，即验证

- 签名方法

  ①直接对消息签名

  ②对消息的散列值签名

- 算法：RSA/ELGamal/DSA

- 攻击方式：中间人/攻击散列函数/利用数字签名攻击公钥

- 应用：安全信息公告/软件下载/公钥证书与SSL/TLS等

**各种密码技术对比**

|              | 对称密码       | 公钥密码                   |
| ------------ | -------------- | -------------------------- |
| 发送者       | 用共享密钥加密 | 用公钥加密                 |
| 接收者       | 用共享密钥解密 | 用私钥解密                 |
| 密钥配送问题 | 存在           | 不存在，但公钥需要另外认证 |
| 机密性       | √              | √                          |

|              | 消息认证码          | 数字签名                   |
| ------------ | ------------------- | -------------------------- |
| 发送者       | 用共享密钥计算MAC   | 用私钥生成签名             |
| 接收者       | 用共享密钥计算MAC   | 用公钥验证签名             |
| 密钥配送问题 | 存在                | 不存在，但公钥需要另外认证 |
| 完整性       | √                   | √                          |
| 认证         | √，仅限通信对象系统 | √，可适用任何第三方        |
| 防止否认     | ×                   | √                          |



### 2. 密钥管理

**网络安全通信模型（保密性）**  

![Image text](https://github.com/Pangxiaox/2020-Learning-FinalExam-Notes/blob/master/%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/keymanage.PNG)  

- 密码算法公开，密钥保密持有而且空间足够大
- 攻击者通常攻击密钥，比如穷举密钥攻击

**密钥配送问题**

- 对称密码

  在大规模的开放性网络中是个难题

- 非对称密码

  公钥公开，没有保密问题

- 解决方式

  ①事先共享

  ②通过密钥分配中心（Key Distribution Center，KDC）

  ③通过Diffie-Hellman密钥交换

  ④通过公钥密码

**Diffie-Hellman密钥交换**

**密钥配送问题：如何实现公钥认证**

- 即使数字签名功能再强大，如果得到的公钥是伪造的，那么数字签名也完全失效

- 数字证书与公钥基础设施（Public Key Infrastructure,PKI)

  ①引入可信第三方（社会学领域概念）

  ②数字证书，又称公钥证书，就是将公钥作为一条消息，由一个可信第三方对其签名后所得到的公钥与签名等数据

  ③基础设施：广泛认可并使用

**数字证书**

- 公钥证书，包含姓名，组织，邮箱等个人信息，以及属于此人的公钥，并有认证机构（CA）施加的数字签名

- 只要看到公钥证书，就可以知道认证机构认定该证书中的公钥的确属于证书中声明的实体

- 认证机构：国际性组织，政府所设立的组织，通过提供认证服务来盈利的一般企业等

  VeriSign公司

- 证书标准规范X.509

- 查看浏览器中的证书，windows证书管理器(certmgr.msc)

**公钥基础设施 PKI**

- 为了能够更有效运用公钥而制定的一系列规范和规格的总称

- PKI的组成要素

  ①用户/实体

  ②认证机构：生成密钥对/注册证书/作废证书与CRL

  ③证书仓库

- 证书的层次结构，证书链

  顶级认证机构 ------>  下一级



### 3. 密码应用与安全

- 银行商业密码
- Web与电商：HTTPS = HTTP + SSL
- 密码应用安全的技术体系



### 第六节课

### 1. 防火墙

**数据保护-可用性**

- 保证数据能够被正常地使用

  ①数据有信息系统存储与处理，因此必须保证信息系统功能的可用性

  ②可用性方面，还要考虑数据备份，容错和容灾等方面

- 保护信息系统功能：访问控制

  ①主机访问控制：通常由操作系统实现

  ②网络访问控制：网络防火墙，入侵检测系统

- 入侵检测系统可视为主动的信息系统保护机制

**网络防火墙**

- 定义

  防火墙是设置在可信任的内部网络与不可信任的外界之间的一道屏障，阻止不希望或者未授权的通信进出内部网络，通过强化边界控制来保障内部的安全，同时不妨碍正常访问行为

- 作用

  ①强化网络安全策略：过滤数据报，拒绝未经允许的访问

  ②防止故障蔓延：对网络进行隔离划分，防止安全问题对全局造成影响

  ③对网络访问进行监控审计和报警

  ④流量控制

- 局限

  ①防火墙可能被绕过：出入的信息必须都经过防火墙，仅允许合法信息通过

  ②对内部出卖性攻击或者内部误操作无效

  ③不能防止数据驱动攻击的攻击

  ④可以阻断攻击，但无法消灭攻击源

  ⑤自身可能被攻击

**网络防火墙基本技术**

- 网络地址转换（Network Address Translation/NAT)

  使用内部和外部两套IP地址，隐藏内部网络拓扑，使得外部主机无法直接发起与内部主机的连接

- 代理服务

  **放图proxy**

  ①定义：代理服务器使用户计算机与Internet之间的中间代理机制，采用客户/服务器工作模式

  ②实质：建立一个数据包的中转机制，并在数据的中转过程中加入一些安全机制-访问

  ③主要实现：

  应用层（应用级代理）：针对每种应用独立开发与部署，如HTTP代理

  传输层（电路级代理）：对应用层透明

- 包过滤

  ①实质：根据数据包特征进行，根据数据包头的一些字段的特征进行过滤

  ②数据包主要特征：

  源地址、目的地址

  源端口、目的端口

  协议：IP、TCP、UDP、ICMP等

  数据包内容中（某些关键字，即特征）：病毒特征码等

  ③包过滤安全策略的制定

  一条过滤规则规定了允许数据包流进或者流入内部网络的一个条件

  最小特权原则

  除了明确禁止和允许的规则外，对没有明确规则的情况，可采用两种策略：

  A. 默认接受：凡未被禁止，即允许

  B. 默认拒绝，凡未被允许，即禁止

  过滤效果与规则排列顺序有关

  🔺两种策略：基于地址和服务（端口）的包过滤

  ④基于地址的数据包过滤策略

  某公司有一个B类网(123.45)。该网的子网(123.45.6.0/24)有若干合作网络(135.79)。管理员希望

  a. 禁止一切来自Internet的对内网的访问

  b. 允许来自合作网络的所有子网(135.79.0.0/16)访问内网(123.45.6.0/24)

  c. 禁止对合作网络的子网(135.79.99.0/24)的访问权

  | 规则 | 源地址        | 目的地址       | 过滤操作 |
  | ---- | ------------- | -------------- | -------- |
  | A    | 135.79.0.0/16 | 123.45.6.0/24  | 允许     |
  | B    | 123.45.6.0/24 | 135.79.0.0/16  | 允许     |
  | C    | 123.45.0.0/16 | 135.79.99.0/24 | 拒绝     |
  | D    | 0.0.0.0/0     | 0.0.0.0/0      | 拒绝     |

- 状态检测

  又称为动态包过滤防火墙

  ①实质：数据包检测方面，对网络的各个层进行实时检测，跟踪每一个有效连接的状态，并根据这些信息决定对该连接是接受还是拒绝

  ②静态数据包过滤（无状态数据包过滤）：仅单独分析每一个数据包，不考虑包内高层的信息以及不同包之间的逻辑关系，也不关心数据传输状态

  ③其检测引擎监视跟踪每一个有效连接的状态，动态地维护一个状态信息表，通过规则表与状态表的共同配合，对表中的各个连接状态因素加以识别

  ④TCP包状态表

  是否为握手数据包，内部主机是否期待该握手包

  是否为数据传输包，状态表中是否存在相应的TCP连接

  ⑤优缺点

  优点：更好的扩展性（应用层之下工作，不需要为每一个应用开发与部署代理服务器程序）

  ​			配置方便，应用范围广（更好支持基于面向无连接协议UDP等的应用）

  缺点：不能分析检测应用层数据（病毒，垃圾邮件等）

**防火墙部署**

- 屏蔽路由器和屏蔽主机（Screening Router&Host）

  在路由器/主机中配置数据包过滤功能

- 双宿主主机（Dual Homed Host）

  该类型主机至少有两个网络接口，用于检查经过它的数据（从一个网络到另外一个网络）

  可在双宿主主机中配置NAT和代理两种安全机制

- 堡垒主机（Bastion Host）

  一个被强化的、被暴露在被保护网络外部的、可预防进攻的计算机

  堡垒主机与内部网络是隔离的，并面对大量的恶意攻击

  分两种结构：

  A. 单连点结构：堡垒主机部署在过滤路由器之后，实现网络层安全（包过滤）和应用层安全（代理），具有比单纯包过滤更高的安全等级

  B. 双连点结构：具有比单连点结构更高的安全等级

- 屏蔽子网（Screened subnet）

  在被保护网络和Internet之间设置一个独立的子网作为防火墙，即为非军事区

  

### 2. 入侵容忍系统

**入侵检测系统**

- 入侵（Intrusion）

  ①收集并利用系统漏洞，比如缓冲区溢出攻击

  ②（分布式）拒绝服务攻击（DDOS）

  ③通过攻击获取系统合法权限

  ④其他造成系统危害的行为

- 入侵检测系统（Intrusion Detection System/IDS）

  ①是对计算机和网络系统资源上的恶意使用行为进行识别和响应的处理系统

  ②IDS作为一种主动的安全防护技术，提供了对内部攻击，外部攻击和误操作的实时保护，被认为是防火墙后面的第二道安全防线

  ③IDS依赖于入侵特征（Signature）数据库进行入侵行为检测

  特征：用于判别通信信息种类的样板数据，如僵尸网络特征等

  ④IDS除了包含检测模块外，通常还提供响应与警报功能

  主动响应：系统将自动阻断攻击工程

  被动响应：系统仅报告与记录发生的事件

  ⑤具体功能：

  监视并分析用户和系统的行为

  审计系统配置和漏洞

  评估敏感系统和数据的完整性

  识别攻击行为，对异常行为进行统计

  实时与事后检测：在系统使用时进行审计还是针对用户操作的历史进行审计

  ⑥通用模型：

  粗略模型、反映入侵检测系统最基本部件

  **放图general**

- 信息收集与数据分析

  ①数据收集的内容

  主机与网络日志文件：登陆记录，用户与用户访问权限变化等

  目录与文件的不期望改变：黑客可能对正常情况下限制访问的文件进行改变（修改，创建和删除等）

  程序执行中的不期望行为：改变进程的行为，使其失败或越权

  物理形式的入侵信息

  ②数据收集机制：准确性、可靠性和效率

  A. 基于主机和基于网络的数据收集机制

  主机：在主机后台运行一个监控程序，检测各种可疑行径

  网络：在网络恰当位置部署网络引擎执行监控任务，检测特定网络数据流

  两种方式具有互补性，可结合使用，构造优化的主动防御体系

  B. 分布式与集中式数据收集机制

  C. 直接监控和间接监控

  直接：从它所监控的对象处获得数据

  间接：由一个单独的进程或工具获得数据

  直接方式更优，但更复杂不容易实现

  D. 外部探测器和内部探测器

  ③数据分析

  对数据源提供的系统运行状态和活动记录进行同步、整理、组织、分类以及各种类型的细致分析，提取其中包含的系统活动特征或者模式，用于对正常和异常行为的判断。

  依据检测目标和数据属性，分为两大类

  A. 异常发现技术：建立系统正常行为轨迹，则与正常行为轨迹不同的系统状态可视为可以异常

  B. 模式发现技术（特征检测或者滥用检测）：基于已知系统缺陷和入侵模式，需要事先定义出非法行为
  
  

### 3. 网络安全体系结构

**放图networksafe1**

**放图networksafe2**



